import{r as c,j as e,u as W,e as Y,g as J}from"./index-CY9RCQaF.js";import{g as K,d as Q,i as Z,b as j,j as G,_ as X,Z as ee,W as b,c as re,l as se,J as oe,K as ne,Y as A,N as ae,S as te,L as ie,$ as L,P as ce,h as de,O as le,Q as pe}from"./Footer-DuzvaY6S.js";import{A as T,a as S,d as I,b as M,T as ue,c as me,e as ye,f as N,g as x,h as he}from"./ExpandMore-BryO5nAP.js";import{I as O,d as k,a as D}from"./VisibilityOff-CAD39nx9.js";import{F,e as U,O as R}from"./OutlinedInput-CqkH6Oax.js";import{C as q}from"./CircularProgress-DNxBWgtV.js";import{A as z}from"./Alert-CQdvH0DM.js";import"./useSlot-oTC37Omy.js";function xe(s){return Q("MuiListItemText",s)}const B=K("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),fe=["children","className","disableTypography","inset","primary","primaryTypographyProps","secondary","secondaryTypographyProps"],ge=s=>{const{classes:r,inset:n,primary:d,secondary:a,dense:u}=s;return se({root:["root",n&&"inset",u&&"dense",d&&a&&"multiline"],primary:["primary"],secondary:["secondary"]},xe,r)},je=Z("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(s,r)=>{const{ownerState:n}=s;return[{[`& .${B.primary}`]:r.primary},{[`& .${B.secondary}`]:r.secondary},r.root,n.inset&&r.inset,n.primary&&n.secondary&&r.multiline,n.dense&&r.dense]}})(({ownerState:s})=>j({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4},s.primary&&s.secondary&&{marginTop:6,marginBottom:6},s.inset&&{paddingLeft:56})),$=c.forwardRef(function(r,n){const d=G({props:r,name:"MuiListItemText"}),{children:a,className:u,disableTypography:t=!1,inset:o=!1,primary:l,primaryTypographyProps:p,secondary:P,secondaryTypographyProps:w}=d,v=X(d,fe),{dense:g}=c.useContext(ee);let m=l??a,y=P;const i=j({},d,{disableTypography:t,inset:o,primary:!!m,secondary:!!y,dense:g}),h=ge(i);return m!=null&&m.type!==b&&!t&&(m=e.jsx(b,j({variant:g?"body2":"body1",className:h.primary,component:p!=null&&p.variant?void 0:"span",display:"block"},p,{children:m}))),y!=null&&y.type!==b&&!t&&(y=e.jsx(b,j({variant:"body2",className:h.secondary,color:"text.secondary",display:"block"},w,{children:y}))),e.jsxs(je,j({className:re(h.root,u),ownerState:i,ref:n},v,{children:[m,y]}))}),we="_container_7y0mr_1",ve="_userData_7y0mr_19",Ce="_passwordsContainer_7y0mr_49",be="_panelAccordion_7y0mr_63",f={container:we,userData:ve,passwordsContainer:Ce,panelAccordion:be};var _={},Pe=ne;Object.defineProperty(_,"__esModule",{value:!0});var H=_.default=void 0,Te=Pe(oe()),E=e;H=_.default=(0,Te.default)([(0,E.jsx)("path",{d:"M18 11c.7 0 1.37.1 2 .29V10c0-1.1-.9-2-2-2h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h6.26c-.79-1.13-1.26-2.51-1.26-4 0-3.87 3.13-7 7-7M8.9 6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1v2H8.9z"},"0"),(0,E.jsx)("path",{d:"M18 13c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5m0 2c.83 0 1.5.67 1.5 1.5S18.83 18 18 18s-1.5-.67-1.5-1.5.67-1.5 1.5-1.5m0 6c-1.03 0-1.94-.52-2.48-1.32.73-.42 1.57-.68 2.48-.68s1.75.26 2.48.68c-.54.8-1.45 1.32-2.48 1.32"},"1")],"LockPerson");function Se(){const s=W(i=>i.user),[r,n]=c.useState(!1),[d,a]=c.useState(""),[u,t]=c.useState("error"),[o,l]=c.useState(!1),[p,P]=c.useState({userId:0,currentPassword:"",newPassword:""}),w=()=>l(i=>!i),v=i=>{i.preventDefault()},g=i=>{const{name:h,value:C}=i.target;P(V=>({...V,[h]:C}))},m=()=>p.currentPassword.trim()?p.newPassword.trim()?"":"New password is required":"current password is required",y=async i=>{i.preventDefault();const h=m();if(h){a(h),t("error");return}if(!s){a("User is not logged in"),t("error");return}n(!0),a("");try{p.userId=s.id,await Y(p)?(a("Password changed successfully"),t("success")):(a("Check if typed current password is correct."),t("error"))}catch(C){console.error("Change password failed:",C),a("Check if typed current password is correct."),t("error")}finally{n(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs("form",{onSubmit:y,className:f.passwordsContainer,children:[e.jsxs(F,{sx:{m:1,width:"25ch","& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"primary.main"},"&:hover fieldset":{borderColor:"primary.main"},"&.Mui-focused fieldset":{borderColor:"primary.main"}},"& .MuiInputLabel-root":{color:"primary.main"}},variant:"outlined",color:"primary",children:[e.jsx(U,{htmlFor:"outlined-adornment-currentPassword",children:"Current password"}),e.jsx(R,{id:"outlined-adornment-currentPassword",type:o?"text":"password",name:"currentPassword",value:p.currentPassword,onChange:g,endAdornment:e.jsx(O,{position:"end",children:e.jsx(A,{"aria-label":"toggle current password visibility",onClick:w,onMouseDown:v,edge:"end",color:"primary",children:o?e.jsx(k,{}):e.jsx(D,{})})}),label:"Current password"})]}),e.jsxs(F,{sx:{m:1,width:"25ch","& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"primary.main"},"&:hover fieldset":{borderColor:"primary.main"},"&.Mui-focused fieldset":{borderColor:"primary.main"}},"& .MuiInputLabel-root":{color:"primary.main"}},variant:"outlined",color:"primary",children:[e.jsx(U,{htmlFor:"outlined-adornment-newPassword",children:"New password"}),e.jsx(R,{id:"outlined-adornment-newPassword",type:o?"text":"password",name:"newPassword",value:p.newPassword,onChange:g,endAdornment:e.jsx(O,{position:"end",children:e.jsx(A,{"aria-label":"toggle new password visibility",onClick:w,onMouseDown:v,edge:"end",color:"primary",children:o?e.jsx(k,{}):e.jsx(D,{})})}),label:"newPassword"})]}),e.jsx(ae,{type:"submit",variant:"contained",endIcon:r?e.jsx(q,{size:20,color:"inherit"}):e.jsx(H,{}),disabled:r,children:r?"Processing...":"Change Password"})]}),d&&e.jsx(z,{severity:u,style:{marginTop:"1rem"},children:d})]})}const Ie=de({components:{MuiAccordion:{styleOverrides:{root:{borderRadius:"8px",backgroundColor:"#191919","&:before":{display:"none"},"&.Mui-expanded":{margin:"8px 0"}}}},MuiAccordionSummary:{styleOverrides:{root:{color:"#1976d2","&.Mui-expanded":{minHeight:48}},content:{"&.Mui-expanded":{margin:"12px 0"}}}},MuiAccordionDetails:{styleOverrides:{root:{color:"#1976d2"}}},MuiTableContainer:{styleOverrides:{root:{backgroundColor:"#0f1214"}}},MuiTableHead:{styleOverrides:{root:{backgroundColor:"#0f1214"}}},MuiTableBody:{styleOverrides:{root:{backgroundColor:"#0f1214"}}},MuiTableCell:{styleOverrides:{root:{color:"#ffffff",borderBottom:"1px solid rgba(255, 255, 255, 0.12)"}}}}});function Me(){const s=W(o=>o.user),[r,n]=c.useState(null),[d,a]=c.useState(!0),[u,t]=c.useState(null);return c.useEffect(()=>{(async()=>{if(!s){t("User not authenticated"),a(!1);return}try{const l=await J(s.id);n(l.data)}catch(l){console.error("Error fetching data:",l),t("Failed to fetch user details")}finally{a(!1)}})()},[s]),d?e.jsx(q,{}):u?e.jsx(z,{severity:"error",children:u}):e.jsx(te,{theme:Ie,children:e.jsx("div",{className:f.container,children:e.jsxs("div",{className:f.userData,children:[e.jsxs(T,{className:f.panelAccordion,children:[e.jsx(S,{expandIcon:e.jsx(I,{}),"aria-controls":"panel1-content",id:"panel1-header",children:"Account Details"}),e.jsx(M,{children:e.jsxs(ie,{children:[e.jsx(L,{children:e.jsx($,{primary:"Name",secondary:r==null?void 0:r.name,primaryTypographyProps:{fontSize:20,fontWeight:"medium",letterSpacing:0},secondaryTypographyProps:{fontSize:20,fontWeight:"medium",letterSpacing:0,color:"white"}})}),e.jsx(L,{children:e.jsx($,{primary:"Favorite Opening",secondary:`${r==null?void 0:r.favoriteOpeningName} (Click count: ${r==null?void 0:r.favoriteOpeningClickCount})`,primaryTypographyProps:{fontSize:20,fontWeight:"medium",letterSpacing:0},secondaryTypographyProps:{fontSize:20,fontWeight:"medium",letterSpacing:0,color:"white"}})})]})})]}),e.jsxs(T,{className:f.panelAccordion,children:[e.jsx(S,{expandIcon:e.jsx(I,{}),"aria-controls":"panel2-content",id:"panel2-header",children:"Change Password"}),e.jsx(M,{children:e.jsx(Se,{})})]}),e.jsxs(T,{className:f.panelAccordion,children:[e.jsx(S,{expandIcon:e.jsx(I,{}),"aria-controls":"panel3-content",id:"panel3-header",children:"Most frequently chosen openings for a given year"}),e.jsx(M,{children:e.jsx(ue,{component:ce,children:e.jsxs(me,{children:[e.jsx(ye,{children:e.jsxs(N,{children:[e.jsx(x,{children:"Year"}),e.jsx(x,{children:"Name"}),e.jsx(x,{children:"Opening Number"}),e.jsx(x,{children:"Click Count"})]})}),e.jsx(he,{children:r==null?void 0:r.userFavouriteOpenings.map((o,l)=>e.jsxs(N,{children:[e.jsx(x,{children:o.year}),e.jsx(x,{children:o.name}),e.jsx(x,{children:o.openingNumber}),e.jsx(x,{children:o.openingClickCount})]},l))})]})})})]})]})})})}function Ue(){return e.jsxs(e.Fragment,{children:[e.jsx(le,{}),e.jsx(Me,{}),e.jsx(pe,{})]})}export{Ue as default};
