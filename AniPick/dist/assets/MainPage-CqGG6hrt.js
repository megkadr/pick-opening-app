import{r as t,j as e,a as U,u as q,b as F,c as G}from"./index-CcnljIkN.js";import{h as Q,i as H,R as X,S as J,U as K,V as Z,W as y,X as ee,N as te,O as oe,Q as se}from"./Footer-BXoTP08e.js";import{g as ae}from"./OpeningsService-DErJXHsO.js";import{C as ne}from"./CircularProgress-BzptA5_e.js";const re="_mainLayout_1cxg0_1",ie="_mainContent_1cxg0_35",ce="_quizTitle_1cxg0_45",le="_backgroundTransition_1cxg0_85",de="_playButton_1cxg0_95",ue="_cardPicks_1cxg0_135",ge="_cardPicksBackground_1cxg0_167",he="_show_1cxg0_181",me="_endingCharacterContener_1cxg0_189",n={mainLayout:re,mainContent:ie,quizTitle:ce,backgroundTransition:le,playButton:de,cardPicks:ue,"fade-out":"_fade-out_1cxg0_151","fade-in":"_fade-in_1cxg0_159",cardPicksBackground:ge,show:he,endingCharacterContener:me},pe="_card_1dvvt_1",ye="_video_1dvvt_25",fe="_videoBackground_1dvvt_53",ve="_animeTitle_1dvvt_91",xe="_spin_1dvvt_1",_e="_movingBorder_1dvvt_129",ke="_moveAround_1dvvt_1",f={card:pe,video:ye,videoBackground:fe,animeTitle:ve,spin:xe,movingBorder:_e,moveAround:ke},je=t.forwardRef(({src:o,title:r,openingNumber:u,onClick:h,className:v,showTitle:d,videoNumber:i},k)=>{const c=t.useRef(null),[j,g]=t.useState(!0);return t.useImperativeHandle(k,()=>c.current,[]),t.useEffect(()=>{const l=c.current;if(l)return l.volume=.2,l.onplay=()=>g(!1),l.onended=()=>g(!0),()=>{g(!0)}},[]),t.useEffect(()=>{g(!0)},[d]),e.jsxs("div",{className:`${f.card} ${v}`,onClick:h,children:[e.jsx("div",{className:f.videoBackground,style:{backgroundImage:`linear-gradient(to bottom right, var(--video-background-${i}-start), var(--video-background-${i}-end))`,display:j&&!d?"flex":"none"},children:e.jsx("p",{children:i})}),e.jsxs("div",{className:f.animeTitle,style:{display:d?"flex":"none"},children:[e.jsx("span",{children:r.toUpperCase()}),e.jsxs("span",{children:["OPENING ",u.toString().toUpperCase()]})]}),e.jsx("div",{className:f.movingBorder,style:{display:d?"flex":"none"}}),e.jsx("video",{className:f.video,src:o,ref:c,playsInline:!0,loop:!1})]})}),be="_year_1tl59_3",we="_yearNumber_1tl59_21",A={year:be,yearNumber:we},Ce=({year:o})=>e.jsx("div",{className:A.year,children:e.jsx("p",{className:A.yearNumber,children:o})}),Se="_visualizer_1tvq9_1",Be={visualizer:Se},Ne="/assets/audio_visualizer-B_0vQihf.gif",Te=()=>e.jsx("div",{className:Be.visualizer,children:e.jsx("img",{src:Ne,alt:"Audio Visualizer"})}),Pe="/assets/todo_background-C_e9vkyL.png",Ae="/assets/ending-character-BRQDT249.png",D="/assets/clap-BhWXJGoe.mp3",I=U(o=>({isWelcomeDialogOpen:!1,closeWelcomeDialog:()=>o({isWelcomeDialogOpen:!1}),checkAndShowWelcomeDialog:()=>{localStorage.getItem("hasSeenWelcomeMessage")||(o({isWelcomeDialogOpen:!0}),localStorage.setItem("hasSeenWelcomeMessage","true"))}})),De=Q({palette:{mode:"dark",background:{paper:"#121212"},text:{primary:"#ffffff",secondary:"#b3b3b3"}}}),Ie=H(X)(({theme:o})=>({"& .MuiPaper-root":{backgroundColor:o.palette.background.paper,color:o.palette.text.primary},"& .MuiDialogContent-root":{padding:o.spacing(2)},"& .MuiDialogActions-root":{padding:o.spacing(1)}})),Ee=()=>{const{isWelcomeDialogOpen:o,closeWelcomeDialog:r}=I();return e.jsx(J,{theme:De,children:e.jsxs(Ie,{open:o,onClose:r,children:[e.jsx(K,{sx:{color:"text.primary"},children:"Welcome to AniPick!"}),e.jsxs(Z,{dividers:!0,children:[e.jsx(y,{gutterBottom:!0,color:"text.primary",children:"Thank you for visiting AniPick! I hope you enjoy your time here."}),e.jsx("hr",{style:{borderColor:"rgba(255, 255, 255, 0.12)"}}),e.jsx(y,{variant:"h6",gutterBottom:!0,color:"text.primary",children:"How to Play"}),e.jsx(y,{gutterBottom:!0,color:"text.primary",children:"After clicking the start button, the game will begin. For each year, a selection of anime openings will be chosen and displayed. The current year is shown at the top of the screen, and each opening will play automatically. Once all the openings from the displayed year have finished playing, you can choose your favorite opening that you believe is the best for that year."}),e.jsx(y,{gutterBottom:!0,color:"text.primary",children:"After you make your selection, the game will progress to the next year, where 6 new anime openings from that year will be randomly selected and played. This process continues year by year, allowing you to choose your favorite opening for each year."}),e.jsx(y,{gutterBottom:!0,color:"red",fontWeight:"bold",children:"Important: If you want to save your selections and view them later, you need to log in to your account. Without logging in, your picks will not be saved. You can access your saved picks in the UserPanel, which is available in the navigation bar after logging in."})]}),e.jsx(ee,{children:e.jsx(te,{onClick:r,color:"primary",children:"Close"})})]})})},We=()=>{const[o,r]=t.useState(0),[u,h]=t.useState(!1),[v,d]=t.useState(!0),[i,k]=t.useState(2e3),[c,j]=t.useState([]),[g,l]=t.useState(!1),S=t.useRef([]),m=t.useRef(null),[E,x]=t.useState(!1),[b,_]=t.useState(!1),[w,W]=t.useState(!1),[$,B]=t.useState(Array(6).fill(!1)),O=new Date().getFullYear(),C=q(a=>a.user),{checkAndShowWelcomeDialog:N}=I(),z=F();t.useEffect(()=>{N()},[N]),t.useEffect(()=>{m.current=new Audio(D)},[]),t.useEffect(()=>{if(u){const a=S.current[o];a&&(a.play().catch(s=>{console.error("Error playing video:",s)}),a.onended=()=>{B(s=>{const p=[...s];return p[o]=!0,p}),o<c.length-1?r(s=>s+1):h(!1)})}},[o,u,c]),t.useEffect(()=>{console.log("Updated openings")},[c]);const T=async a=>{l(!0);try{const s=await ae(a);j(s),l(!1)}catch(s){console.error("Error fetching openings:",s),l(!1)}},P=()=>{m.current&&(m.current.load(),m.current.play().catch(a=>{console.error("Error playing clap sound:",a)}))},V=async a=>{if(!u){const s=i+1;if(C){const L={userId:C.id,openingId:a,year:i};try{await G(L)}catch(Y){console.error("Error sending UserClaims to backend:",Y)}}s<=O?(P(),r(0),B(Array(6).fill(!1)),x(!0),_(!0),k(s),await T(s),setTimeout(()=>{h(!0),x(!1),_(!1)},1e3)):(d(!1),W(!0))}},M=async()=>{d(!1),x(!0),_(!0),P(),await T(i),setTimeout(()=>{h(!0),x(!1),_(!1)},1e3)},R=()=>{C&&z("/userPanel")};return e.jsxs("div",{className:n.mainLayout,children:[e.jsxs("div",{className:n.mainContent,children:[e.jsx(Ce,{year:i}),u?e.jsx(Te,{}):e.jsx("div",{className:n.quizTitle,children:e.jsx("h1",{children:"ONLY SAVE 1 OPENING!"})})]}),e.jsxs("div",{className:`${n.cardPicks} ${E?n["fade-out"]:n["fade-in"]}`,children:[e.jsx("div",{className:`${n.cardPicksBackground} ${b?n.show:""}`,style:{display:b?"block":"none"},children:e.jsx("img",{className:n.backgroundTransition,src:Pe,alt:"background transition"})}),e.jsx("div",{className:`${n.endingCharacterContener} ${w?n.show:""}`,style:{display:w?"flex":"none"},children:e.jsx("img",{className:n.backgroundTransition,src:Ae,alt:"background character",onClick:R})}),v&&e.jsx("button",{className:n.playButton,onClick:M,children:"Play"}),!v&&!w&&(g&&!b?e.jsx(ne,{style:{height:"14rem",width:"14rem",position:"absolute",color:"red"}}):c.map((a,s)=>e.jsx(je,{src:a.src,openingNumber:a.openingNumber,title:a.title,onClick:()=>V(a.id),ref:p=>S.current[s]=p,className:n.cardItem,showTitle:$[s],videoNumber:s+1},s)))]}),e.jsx("audio",{ref:m,src:D}),e.jsx(Ee,{})]})},$e=We;function Le(){return e.jsxs(e.Fragment,{children:[e.jsx(oe,{}),e.jsx($e,{}),e.jsx(se,{})]})}export{Le as default};
