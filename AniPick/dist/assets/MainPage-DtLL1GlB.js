import{r as s,j as e,n as R,C as O}from"./index-CLzlqFXC.js";import{N as Y,F as U}from"./Footer-DXleCn23.js";import{g as F}from"./OpeningsService-BxVWRY1L.js";import{a as D}from"./UserService-Ddfz-gWS.js";import"./AxiosClient-CYet-Wq1.js";const G="_mainLayout_2qwku_1",M="_mainContent_2qwku_35",Q="_quizTitle_2qwku_45",H="_backgroundTransition_2qwku_85",J="_playButton_2qwku_95",W="_cardPicks_2qwku_135",X="_cardPicksBackground_2qwku_167",K="_show_2qwku_181",Z="_endingCharacterContener_2qwku_189",a={mainLayout:G,mainContent:M,quizTitle:Q,backgroundTransition:H,playButton:J,cardPicks:W,"fade-out":"_fade-out_2qwku_151","fade-in":"_fade-in_2qwku_159",cardPicksBackground:X,show:K,endingCharacterContener:Z},ee="_card_ccpyp_1",se="_video_ccpyp_25",ne="_videoBackground_ccpyp_53",te="_animeTitle_ccpyp_91",ae="_spin_ccpyp_1",re="_movingBorder_ccpyp_129",oe="_moveAround_ccpyp_1",m={card:ee,video:se,videoBackground:ne,animeTitle:te,spin:ae,movingBorder:re,moveAround:oe},ce=s.forwardRef(({src:r,title:_,openingNumber:l,onClick:g,className:y,showTitle:u,videoNumber:o},v)=>{const c=s.useRef(null),[x,d]=s.useState(!0);return s.useImperativeHandle(v,()=>c.current,[]),s.useEffect(()=>{const i=c.current;if(i)return i.volume=.2,i.onplay=()=>d(!1),i.onended=()=>d(!0),()=>{d(!0)}},[]),s.useEffect(()=>{d(!0)},[u]),e.jsxs("div",{className:`${m.card} ${y}`,onClick:g,children:[e.jsx("div",{className:m.videoBackground,style:{backgroundImage:`linear-gradient(to bottom right, var(--video-background-${o}-start), var(--video-background-${o}-end))`,display:x&&!u?"flex":"none"},children:e.jsx("p",{children:o})}),e.jsxs("div",{className:m.animeTitle,style:{display:u?"flex":"none"},children:[e.jsx("span",{children:_.toUpperCase()}),e.jsxs("span",{children:["OPENING ",l.toString().toUpperCase()]})]}),e.jsx("div",{className:m.movingBorder,style:{display:u?"flex":"none"}}),e.jsx("video",{className:m.video,src:r,ref:c,playsInline:!0,loop:!1})]})}),ie="_year_bxjib_3",ue="_yearNumber_bxjib_21",q={year:ie,yearNumber:ue},le=({year:r})=>e.jsx("div",{className:q.year,children:e.jsx("p",{className:q.yearNumber,children:r})}),de="_visualizer_1tvq9_1",ge={visualizer:de},pe="/assets/audio_visualizer-B_0vQihf.gif",fe=()=>e.jsx("div",{className:ge.visualizer,children:e.jsx("img",{src:pe,alt:"Audio Visualizer"})}),me="/assets/todo_background-C_e9vkyL.png",_e="/assets/ending-character-BRQDT249.png",E="/assets/clap-BhWXJGoe.mp3",ye=()=>{const[r,_]=s.useState(0),[l,g]=s.useState(!1),[y,u]=s.useState(!0),[o,v]=s.useState(2e3),[c,x]=s.useState([]),[d,i]=s.useState(!1),w=s.useRef([]),p=s.useRef(null),[N,h]=s.useState(!1),[B,k]=s.useState(!1),[j,P]=s.useState(!1),[$,C]=s.useState(Array(6).fill(!1)),I=new Date().getFullYear(),b=R(t=>t.user);s.useEffect(()=>{p.current=new Audio(E)},[]),s.useEffect(()=>{if(l){const t=w.current[r];t&&(t.play().catch(n=>{console.error("Error playing video:",n)}),t.onended=()=>{C(n=>{const f=[...n];return f[r]=!0,f}),r<c.length-1?_(n=>n+1):g(!1)})}},[r,l,c]),s.useEffect(()=>{console.log("Updated openings")},[c]);const S=async t=>{i(!0);try{const n=await F(t);x(n),i(!1)}catch(n){console.error("Error fetching openings:",n),i(!1)}},T=()=>{p.current&&(p.current.load(),p.current.play().catch(t=>{console.error("Error playing clap sound:",t)}))},A=async t=>{if(!l){const n=o+1;if(n!==I+1){if(T(),_(0),C(Array(6).fill(!1)),h(!0),k(!0),b){const V={userId:b.id,openingId:t,year:o};try{await D(V)}catch(L){console.error("Error sending UserClaims to backend:",L)}}v(n),await S(n),setTimeout(()=>{g(!0),h(!1),k(!1)},1e3)}else u(!1),P(!0)}},z=async()=>{u(!1),h(!0),k(!0),T(),await S(o),setTimeout(()=>{g(!0),h(!1),k(!1)},1e3)};return e.jsxs("div",{className:a.mainLayout,children:[e.jsxs("div",{className:a.mainContent,children:[e.jsx(le,{year:o}),l?e.jsx(fe,{}):e.jsx("div",{className:a.quizTitle,children:e.jsx("h1",{children:"ONLY SAVE 1 OPENING!"})})]}),e.jsxs("div",{className:`${a.cardPicks} ${N?a["fade-out"]:a["fade-in"]}`,children:[e.jsx("div",{className:`${a.cardPicksBackground} ${B?a.show:""}`,style:{display:B?"block":"none"},children:e.jsx("img",{className:a.backgroundTransition,src:me,alt:"background transition"})}),e.jsx("div",{className:`${a.endingCharacterContener} ${j?a.show:""}`,style:{display:j?"flex":"none"},children:e.jsx("img",{className:a.backgroundTransition,src:_e,alt:"background character"})}),y&&e.jsx("button",{className:a.playButton,onClick:z,children:"Play"}),!y&&!j&&(d&&!N?e.jsx(O,{style:{height:"14rem",width:"14rem",position:"absolute",color:"red"}}):c.map((t,n)=>e.jsx(ce,{src:t.src,openingNumber:t.openingNumber,title:t.title,onClick:()=>A(t.id),ref:f=>w.current[n]=f,className:a.cardItem,showTitle:$[n],videoNumber:n+1},n)))]}),e.jsx("audio",{ref:p,src:E})]})},he=ye;function Be(){return e.jsxs(e.Fragment,{children:[e.jsx(Y,{}),e.jsx(he,{}),e.jsx(U,{})]})}export{Be as default};
